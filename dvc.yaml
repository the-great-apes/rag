stages:
  parse:
    cmd: python -m src.parse
    params:
      - data.raw
      - data.parsed
    deps:
      - src/parse.py
      - ${data.raw}
    outs:
      - ${data.parsed}

  clean:
    cmd: python -m src.clean
    params:
      - data.parsed
      - data.clean
    deps:
      - src/clean.py
      - ${data.parsed}
    outs:
      - ${data.clean}

  chunk:
    cmd: python -m src.chunk
    params:
      - data.clean
      - data.chunk
    deps:
      - src/chunk.py
      - ${data.clean}
    outs:
      - ${data.chunk}

  index:
    cmd: python -m src.index
    params:
      - data.chunk
      - data.index
    deps:
      - src/chunk.py
      - ${data.chunk}
    outs:
      - ${data.index}

  extract:
    cmd: python -m src.extract
    params:
      - data.index
      - data.summary
      - extraction
    deps:
      - src/extract.py
      - ${data.index}
    outs:
      - ${data.summary}


  upload_mongo:
    cmd: python -m src.upload_data.upload_to_mongodb
    params:
      - data.summary
    deps:
      - src/upload_to_mongodb/upload_to_mongodb.py
      - src/upload_to_mongodb/write_data.py
      - ${data.summary}
    outs:
      - ${data.mongo}