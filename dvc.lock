schema: '2.0'
stages:
  parse:
    cmd: python -m src.parse
    deps:
    - path: data/raw/
      hash: md5
      md5: af2be1f607b53c28f5568418bb0931e0.dir
      size: 815161371
      nfiles: 39
    - path: src/parse.py
      hash: md5
      md5: 8e242c871587348c1b953c8fe18a77f8
      size: 1387
    params:
      params.yaml:
        data.parsed: data/parsed/
        data.raw: data/raw/
    outs:
    - path: data/parsed/
      hash: md5
      md5: 9f2cce5c1c77c56a82b02e1fbc70e6cc.dir
      size: 8361445
      nfiles: 15
  clean:
    cmd: python -m src.clean
    deps:
    - path: data/parsed/
      hash: md5
      md5: 9f2cce5c1c77c56a82b02e1fbc70e6cc.dir
      size: 8361445
      nfiles: 15
    - path: src/clean.py
      hash: md5
      md5: ca662ded2dbd85890e3d7407fa72c3c4
      size: 1581
    - path: src/helpers.py
      hash: md5
      md5: 8c134c7850f5187ec20ad3ef69ecf4f3
      size: 1459
    params:
      params.yaml:
        data.clean: data/clean/
        data.parsed: data/parsed/
    outs:
    - path: data/clean/
      hash: md5
      md5: 9dc4554dd30b494d9ffb1a9311ed4edc.dir
      size: 7860116
      nfiles: 15
  chunk:
    cmd: python -m src.chunk
    deps:
    - path: data/clean/
      hash: md5
      md5: 9dc4554dd30b494d9ffb1a9311ed4edc.dir
      size: 7860116
      nfiles: 15
    - path: src/chunk.py
      hash: md5
      md5: be0e8eded6fee8f56ac3c6738eaad349
      size: 2286
    - path: src/helpers.py
      hash: md5
      md5: 8c134c7850f5187ec20ad3ef69ecf4f3
      size: 1459
    params:
      params.yaml:
        data.chunk: data/chunk/
        data.clean: data/clean/
    outs:
    - path: data/chunk/
      hash: md5
      md5: 001a984a995c873b2f700bc516f06332.dir
      size: 15771211
      nfiles: 15
  index:
    cmd: python -m src.index
    deps:
    - path: data/chunk/
      hash: md5
      md5: 001a984a995c873b2f700bc516f06332.dir
      size: 15771211
      nfiles: 15
    - path: src/chunk.py
      hash: md5
      md5: be0e8eded6fee8f56ac3c6738eaad349
      size: 2286
    - path: src/helpers.py
      hash: md5
      md5: 8c134c7850f5187ec20ad3ef69ecf4f3
      size: 1459
    params:
      params.yaml:
        data.chunk: data/chunk/
        data.index: data/index/
    outs:
    - path: data/index/
      hash: md5
      md5: 2f6f6375ec3e561f173e4294f9bdb893.dir
      size: 244703688
      nfiles: 75
  exrtact:
    cmd: python -m src.extract
    deps:
    - path: data/index/
      hash: md5
      md5: 2f6f6375ec3e561f173e4294f9bdb893.dir
      size: 244703688
      nfiles: 75
    - path: src/extract.py
      hash: md5
      md5: bc8d1b9e6e50289140062194401e2f1e
      size: 5063
    params:
      params.yaml:
        data.index: data/index/
        data.summary: data/summary/
        extraction:
          citation_chunk_size: 1024
          kpis:
          - revenue
          - cash flow
          - Cost of Goods Sold (COGS) / Cost of Materials
          - Depreciation
          - Amortization
          - Purchase Price Allocation (PPA) / Purchase Price Adjustmen
          templates:
            driver: make a short summary about the major drivers behind {company}s
              {kpi} change in {year}?
            kpi: "- Your job is to find a Key Performance indicator (KPI) for {company}\
              \ and format/return it\n- in the base number system (not Million/Billion)\
              \ as well as retrieve the currency.\\n\n- ------------------------------------\n\
              - Example:\n- IBM's revenue for the year was $61.9 billion. -> 61900000000\n\
              - ------------------------------------\n- find the {kpi} KPI\n- ------------------------------------\n\
              - the output is only the formatted number and currency and nothing else!\n\
              - if you don't find the KPI, output 'KPI not found'\n- ------------------------------------\n\
              - Example output where KPI is found:\n- 61900000000, $\n- Example output\
              \ where KPI is NOT found:\n- KPI not found\n"
    outs:
    - path: data/summary/
      hash: md5
      md5: 3e5371eb9de9ee2a46984d64a21a168c.dir
      size: 254706
      nfiles: 15
